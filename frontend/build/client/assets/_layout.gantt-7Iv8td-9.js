import{a as i,o as e,v,w as y}from"./chunk-NL6KNZEE-DVU-DdLP.js";import{a as _}from"./sdk.gen-ZuoAz7BR.js";const N=({isOpen:d,onClose:o,project:s,onSave:g})=>{const[r,x]=i.useState({id:"",company_name:"",location_name:"",description:"",tags:"",start_date:"",end_date:""}),[u,p]=i.useState(!1),[f,m]=i.useState(null),h=t=>{if(!t)return"";if(typeof t=="string"){const a=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(a)return`${a[1]}-${a[2]}-${a[3]}`}if(typeof t=="object"){const a=t["time.Time"];if(a){const n=a.match(/^(\d{4})-(\d{2})-(\d{2})/);if(n)return`${n[1]}-${n[2]}-${n[3]}`}}return""};i.useEffect(()=>{if(s){const t=h(s.start_date),a=h(s.end_date);console.log("Project dates extracted:",{startDate:t,endDate:a}),x({id:s.id||"",company_name:s.company_name||"",location_name:s.location_name||"",description:s.description||"",tags:Array.isArray(s.tags)?s.tags.join(", "):s.tags||"",start_date:t,end_date:a}),m(null)}},[s]);const l=t=>{const{name:a,value:n}=t.target;x(c=>({...c,[a]:n}))},j=async t=>{if(t.preventDefault(),!!s){p(!0),m(null);try{const a={...s,company_name:r.company_name,location_name:r.location_name,description:r.description,tags:r.tags?r.tags.split(",").map(n=>n.trim()).filter(n=>n.length>0):[],start_date:r.start_date?{"time.Time":`${r.start_date}T00:00:00+09:00`}:void 0,end_date:r.end_date?{"time.Time":`${r.end_date}T23:59:59+09:00`}:void 0};console.log("Saving project with dates:",a),await g(a),o()}catch(a){console.error("Error saving project:",a),m(a instanceof Error?a.message:"ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{p(!1)}}};return d?e.jsx("div",{className:"modal-overlay",onClick:o,children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"å·¥äº‹è©³ç´°ç·¨é›†"}),e.jsx("button",{type:"button",className:"close-button",onClick:o,children:"Ã—"})]}),f&&e.jsx("div",{className:"error-message",children:f}),e.jsxs("form",{onSubmit:j,className:"modal-body",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group form-group-half",children:[e.jsx("label",{htmlFor:"company_name",children:"ä¼šç¤¾å"}),e.jsx("input",{type:"text",id:"company_name",name:"company_name",value:r.company_name,onChange:l,className:"path-input",required:!0})]}),e.jsxs("div",{className:"form-group form-group-half",children:[e.jsx("label",{htmlFor:"location_name",children:"ç¾å ´å"}),e.jsx("input",{type:"text",id:"location_name",name:"location_name",value:r.location_name,onChange:l,className:"path-input",required:!0})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group form-group-half",children:[e.jsx("label",{htmlFor:"start_date",children:"é–‹å§‹æ—¥"}),e.jsx("input",{type:"date",id:"start_date",name:"start_date",value:r.start_date,onChange:l,className:"path-input"})]}),e.jsxs("div",{className:"form-group form-group-half",children:[e.jsx("label",{htmlFor:"end_date",children:"çµ‚äº†æ—¥"}),e.jsx("input",{type:"date",id:"end_date",name:"end_date",value:r.end_date,onChange:l,className:"path-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",children:"èª¬æ˜"}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:l,className:"path-input",rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"tags",children:"ã‚¿ã‚°"}),e.jsx("input",{type:"text",id:"tags",name:"tags",value:r.tags,onChange:l,className:"path-input",placeholder:"ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›"})]}),(s==null?void 0:s.managed_files)&&s.managed_files.length>0&&e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ« (",s.managed_files.length,"ä»¶)"]}),e.jsxs("div",{className:"managed-files-table",children:[e.jsxs("div",{className:"files-header",children:[e.jsx("div",{className:"header-item",children:"ç¨®åˆ¥"}),e.jsx("div",{className:"header-item",children:"ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹"}),e.jsx("div",{className:"header-item",children:"çŠ¶æ…‹"})]}),e.jsx("div",{className:"files-body",children:s.managed_files.map((t,a)=>e.jsxs(v.Fragment,{children:[t.current&&e.jsxs("div",{className:"file-row",children:[e.jsxs("div",{className:"file-type",children:[e.jsx("span",{className:"file-icon",children:"ğŸ“"}),"ç¾åœ¨ãƒ•ã‚¡ã‚¤ãƒ«"]}),e.jsx("div",{className:"file-path",children:t.current}),e.jsx("div",{className:"file-status",children:e.jsx("span",{className:"status-current",children:"ä½¿ç”¨ä¸­"})})]}),t.recommended&&e.jsxs("div",{className:"file-row",children:[e.jsxs("div",{className:"file-type",children:[e.jsx("span",{className:"file-icon",children:"ğŸ’¡"}),"æ¨å¥¨ãƒ•ã‚¡ã‚¤ãƒ«"]}),e.jsx("div",{className:"file-path",children:t.recommended}),e.jsx("div",{className:"file-status",children:e.jsx("span",{className:"status-recommended",children:"æ¨å¥¨"})})]})]},a))})]})]}),s&&(!s.managed_files||s.managed_files.length===0)&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«"}),e.jsxs("div",{className:"no-managed-files",children:[e.jsx("span",{className:"no-files-icon",children:"ğŸ“„"}),e.jsx("span",{children:"ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚ã‚Šã¾ã›ã‚“"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-button",onClick:o,disabled:u,children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsx("button",{type:"submit",className:"submit-button",disabled:u,children:u?"ä¿å­˜ä¸­...":"ä¿å­˜"})]})]})]})}):null},b=()=>{const[d,o]=i.useState([]),[s,g]=i.useState(!0),[r,x]=i.useState(null),[u,p]=i.useState(null),[f,m]=i.useState(!1),h=async()=>{try{g(!0),x(null);const a=await _();a.data?o(a.data):o([])}catch(a){console.error("Error loading kouji entries:",a),x(`å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${a instanceof Error?a.message:String(a)}`)}finally{g(!1)}};i.useEffect(()=>{h()},[]);const l=a=>{p(a),m(!0)},j=async a=>{try{const n=await fetch("http://localhost:8080/api/project/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){const c=await n.json();throw new Error(c.message||"ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}console.log("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæ­£å¸¸ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸ"),await h()}catch(n){throw console.error("Error saving project:",n),n}},t=()=>{m(!1),p(null)};return s?e.jsx("div",{style:{padding:"20px"},children:e.jsx("div",{children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­..."})}):r?e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("div",{style:{color:"red",padding:"10px",backgroundColor:"#ffe6e6",borderRadius:"4px"},children:r}),e.jsx("button",{onClick:h,style:{marginTop:"10px",padding:"10px 20px"},children:"å†è©¦è¡Œ"})]}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("div",{style:{marginBottom:"20px"},children:e.jsxs("p",{children:["å–å¾—ã—ãŸå·¥äº‹ãƒ‡ãƒ¼ã‚¿: ",d.length,"ä»¶"]})}),e.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden"},children:[e.jsx("div",{style:{backgroundColor:"#f5f5f5",padding:"10px",fontWeight:"bold",borderBottom:"1px solid #ddd"},children:"å·¥äº‹ä¸€è¦§"}),d.length===0?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"}):e.jsx("div",{children:d.map((a,n)=>e.jsxs("div",{style:{padding:"15px",borderBottom:n<d.length-1?"1px solid #eee":"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",transition:"background-color 0.3s"},onClick:()=>l(a),onMouseEnter:c=>c.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:c=>c.currentTarget.style.backgroundColor="transparent",title:"ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç·¨é›†",children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[a.company_name||"ä¼šç¤¾åæœªè¨­å®š"," - ",a.location_name||"ç¾å ´åæœªè¨­å®š"]}),e.jsxs("div",{style:{fontSize:"14px",color:"#666",marginTop:"5px"},children:["é–‹å§‹: ",a.start_date?new Date(a.start_date).toLocaleDateString("ja-JP"):"æœªè¨­å®š"," | çµ‚äº†: ",a.end_date?new Date(a.end_date).toLocaleDateString("ja-JP"):"æœªè¨­å®š"]})]}),e.jsx("div",{style:{padding:"4px 12px",borderRadius:"4px",backgroundColor:a.status==="é€²è¡Œä¸­"?"#4CAF50":a.status==="å®Œäº†"?"#9E9E9E":a.status==="äºˆå®š"?"#FF9800":"#2196F3",color:"white",fontSize:"12px"},children:a.status||"æœªè¨­å®š"})]},a.id||n))})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f0f8ff",borderRadius:"4px"},children:[e.jsx("h3",{children:"ä½¿ç”¨æ–¹æ³•"}),e.jsxs("p",{children:["ğŸ“ ",e.jsx("strong",{children:"ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯"}),"ã—ã¦å·¥äº‹æƒ…å ±ã‚’ç·¨é›†ã§ãã¾ã™"]}),e.jsx("p",{children:"âœ… é–‹å§‹æ—¥ãƒ»çµ‚äº†æ—¥ãƒ»èª¬æ˜ãƒ»ã‚¿ã‚°ãƒ»ä¼šç¤¾åãƒ»ç¾å ´åã‚’ç·¨é›†å¯èƒ½"}),e.jsx("p",{children:"ğŸ’¾ ç·¨é›†å¾Œã¯è‡ªå‹•ã§ä¿å­˜ã•ã‚Œã¾ã™"}),e.jsx("h3",{style:{marginTop:"15px"},children:"é–‹ç™ºçŠ¶æ³"}),e.jsx("p",{children:"âœ… å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—"}),e.jsx("p",{children:"âœ… ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½"}),e.jsx("p",{children:"ğŸ”„ ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰"})]}),e.jsx(N,{isOpen:f,onClose:t,project:u,onSave:j})]})},w=y(function(){return e.jsx(b,{})});export{w as default};
