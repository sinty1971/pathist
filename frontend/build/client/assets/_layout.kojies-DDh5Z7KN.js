import{a,o as e,s as I,w as O}from"./chunk-QMGIS6GS-CRLmNMPd.js";import{Q as L,R as M}from"./sdk.gen-1y8RMMdH.js";import{K as P}from"./KojiDetailModal-BnI-BK5R.js";import{u as B}from"./KojiContext-CrloO4lv.js";/* empty css                             */import"./index-BXUbddt1.js";import"./Close-XszXWwct.js";import"./useThemeProps-Q2zdfQ03.js";const U=()=>{const[c,m]=a.useState([]),[w,y]=a.useState(!0),[f,j]=a.useState(null),[r,p]=a.useState(null),[S,g]=a.useState(!1),[b,N]=a.useState(!1),[C,v]=a.useState(!1),{setKojiCount:_}=B(),x=async()=>{try{y(!0),j(null);const s=await L();s.data?(m(s.data),_(s.data.length)):(m([]),_(0))}catch(s){console.error("Error loading kouji entries:",s),j(`å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${s instanceof Error?s.message:String(s)}`)}finally{y(!1)}};a.useEffect(()=>{x()},[]);const E=s=>{p(s),g(!0)},K=async s=>{try{const t=await M({body:s});if(t.data)return m(i=>i.map(n=>n.path===t.data.path?t.data:n)),t.data;throw new Error("æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(t){throw console.error("Error updating koji:",t),t}},R=()=>{g(!1),p(null)},T=s=>!s.managed_files||s.managed_files.length===0?!1:s.managed_files.some(i=>i.current&&i.recommended&&i.current!==i.recommended),D=s=>{p(s),r&&r.path!==s.path&&v(!0),m(t=>{const i=t.findIndex(n=>n.path===s.path);if(i!==-1){const n=[...t];return n[i]=s,n}else{const n=t.findIndex(l=>r&&l.path===r.path);if(n!==-1){const l=[...t];return l.splice(n,1),l.push(s),l.sort((d,o)=>{const u=d.start_date?new Date(typeof d.start_date=="string"?d.start_date:d.start_date["time.Time"]).getTime():0,h=o.start_date?new Date(typeof o.start_date=="string"?o.start_date:o.start_date["time.Time"]).getTime():0;return u>0&&h===0?-1:u===0&&h>0?1:u>0&&h>0?h-u:(o.name||"").localeCompare(d.name||"")})}else return[...t,s]}})};return w?e.jsx("div",{className:"business-entity-loading",children:e.jsx("div",{children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­..."})}):f?e.jsxs("div",{className:"business-entity-error",children:[e.jsx("div",{className:"business-entity-error-message",children:f}),e.jsx("button",{onClick:x,className:"business-entity-retry-button",children:"å†è©¦è¡Œ"})]}):e.jsxs("div",{className:"business-entity-container",children:[e.jsxs("div",{className:"business-entity-controls",children:[e.jsx(I,{to:"/kojies/gantt",className:"business-entity-gantt-button",children:"ðŸ“Š å·¥ç¨‹è¡¨ã‚’è¡¨ç¤º"}),e.jsxs("div",{className:"business-entity-count",children:["å…¨",c.length,"ä»¶"]})]}),b&&e.jsxs("div",{className:"business-entity-help-box",children:[e.jsx("button",{onClick:()=>N(!1),className:"business-entity-help-close",title:"é–‰ã˜ã‚‹",children:"Ã—"}),e.jsx("h3",{style:{marginTop:0},children:"ä½¿ç”¨æ–¹æ³•"}),e.jsxs("p",{children:["ðŸ“ ",e.jsx("strong",{children:"ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯"}),"ã—ã¦å·¥äº‹æƒ…å ±ã‚’ç·¨é›†ã§ãã¾ã™"]}),e.jsx("p",{children:"âœ… é–‹å§‹æ—¥ãƒ»çµ‚äº†æ—¥ãƒ»èª¬æ˜Žãƒ»ã‚¿ã‚°ãƒ»ä¼šç¤¾åãƒ»ç¾å ´åã‚’ç·¨é›ˆå¯èƒ½"}),e.jsx("p",{children:"ðŸ’¾ ç·¨é›†å¾Œã¯è‡ªå‹•ã§ä¿å­˜ã•ã‚Œã¾ã™"}),e.jsx("h3",{style:{marginTop:"15px"},children:"é–‹ç™ºçŠ¶æ³"}),e.jsx("p",{children:"âœ… å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—"}),e.jsx("p",{children:"âœ… ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½"}),e.jsx("p",{children:"ðŸ”„ å·¥ç¨‹è¡¨æ©Ÿèƒ½ï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰"})]}),e.jsxs("div",{className:"business-entity-list-container",children:[e.jsxs("div",{className:"business-entity-list-header",children:[e.jsx("div",{className:"business-entity-header-date",children:"é–‹å§‹æ—¥"}),e.jsx("div",{className:"business-entity-header-company",children:"ä¼šç¤¾å"}),e.jsx("div",{className:"business-entity-header-location",children:"ç¾å ´å"}),e.jsx("div",{className:"business-entity-header-spacer"}),e.jsx("div",{className:"business-entity-header-date",style:{marginRight:"24px"},children:"çµ‚äº†æ—¥"}),e.jsx("div",{className:"business-entity-header-status",children:"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"}),e.jsx("button",{onClick:()=>N(!b),className:"business-entity-help-button",title:"ä½¿ç”¨æ–¹æ³•ã‚’è¡¨ç¤º",children:"?"})]}),e.jsx("div",{className:"business-entity-scroll-area",children:c.length===0?e.jsx("div",{className:"business-entity-empty",children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"}):e.jsx("div",{children:c.map((s,t)=>e.jsxs("div",{className:"business-entity-item-row",onClick:()=>E(s),title:"ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç·¨é›†",children:[e.jsxs("div",{className:"business-entity-item-info",children:[e.jsx("div",{className:"business-entity-item-info-date",children:s.start_date?new Date(typeof s.start_date=="string"?s.start_date:s.start_date["time.Time"]).toLocaleDateString("ja-JP"):"æœªè¨­å®š"}),e.jsx("div",{className:"business-entity-item-info-company",children:s.company_name||"ä¼šç¤¾åæœªè¨­å®š"}),e.jsx("div",{className:"business-entity-item-info-location",children:s.location_name||"ç¾å ´åæœªè¨­å®š"}),e.jsx("div",{className:"business-entity-item-info-description",children:s.description||""}),e.jsxs("div",{className:"business-entity-item-info-date end-date",style:{marginRight:"24px"},children:["ï½ž",s.end_date?new Date(typeof s.end_date=="string"?s.end_date:s.end_date["time.Time"]).toLocaleDateString("ja-JP"):"æœªè¨­å®š"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[T(s)&&e.jsx("span",{className:"business-entity-item-rename-indicator",title:"ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰å¤‰æ›´ãŒå¿…è¦ã§ã™",children:"âš ï¸"}),e.jsx("div",{className:`business-entity-item-status ${s.status==="é€²è¡Œä¸­"?"business-entity-item-status-ongoing":s.status==="å®Œäº†"?"business-entity-item-status-completed":s.status==="äºˆå®š"?"business-entity-item-status-planned":""}`,children:s.status||"æœªè¨­å®š"})]})]},s.id||t))})})]}),e.jsx(P,{isOpen:S,onClose:()=>{R(),C&&(x(),v(!1))},koji:r,onUpdate:K,onKojiUpdate:D})]})},G=O(function(){return e.jsx(U,{})});export{G as default};
