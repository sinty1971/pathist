import{a as o,o as t,s as z,w as W}from"./chunk-QMGIS6GS-CRLmNMPd.js";import{R as P}from"./sdk.gen-C0JJsBdk.js";import{P as A}from"./ProjectDetailModal-BfP-5M3c.js";import{u as D}from"./ProjectContext-DQ4aDs3-.js";import"./index-BXUbddt1.js";const I=()=>{const[l,c]=o.useState([]),[S,h]=o.useState(!0),[f,u]=o.useState(null),[_,g]=o.useState(null),[k,m]=o.useState(!1),[y,j]=o.useState(!1),{setProjectCount:b}=D(),v=async()=>{try{h(!0),u(null);const e=await P();e.data?(c(e.data),b(e.data.length)):(c([]),b(0))}catch(e){console.error("Error loading kouji entries:",e),u(`å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${e instanceof Error?e.message:String(e)}`)}finally{h(!1)}};o.useEffect(()=>{v()},[]);const w=e=>{g(e),m(!0)},C=async e=>{try{const n=await fetch("http://localhost:8080/api/project/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const r=await n.json();throw new Error(r.message||"æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}const i=await n.json();return c(r=>r.map(s=>s.id===i.id?i:s)),i}catch(n){throw console.error("Error updating project:",n),n}},R=()=>{m(!1),g(null)},E=e=>!e.managed_files||e.managed_files.length===0?!1:e.managed_files.some(i=>i.current&&i.recommended&&i.current!==i.recommended),T=e=>{g(e),c(n=>{const i=n.findIndex(r=>r.id===e.id);if(i!==-1){const r=[...n];return r[i]=e,r}else{const r=n.findIndex(s=>s.company_name===e.company_name&&s.location_name===e.location_name&&s.id!==e.id);if(r!==-1){const s=[...n];return s.splice(r,1),s.push(e),s.sort((d,a)=>{const x=d.start_date?new Date(typeof d.start_date=="string"?d.start_date:d.start_date["time.Time"]).getTime():0,p=a.start_date?new Date(typeof a.start_date=="string"?a.start_date:a.start_date["time.Time"]).getTime():0;return x>0&&p===0?-1:x===0&&p>0?1:x>0&&p>0?p-x:(a.name||"").localeCompare(d.name||"")})}else return[...n,e]}})};return S?t.jsx("div",{style:{padding:"20px"},children:t.jsx("div",{children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­..."})}):f?t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{style:{color:"red",padding:"10px",backgroundColor:"#ffe6e6",borderRadius:"4px"},children:f}),t.jsx("button",{onClick:v,style:{marginTop:"10px",padding:"10px 20px"},children:"å†è©¦è¡Œ"})]}):t.jsxs("div",{style:{padding:"20px",paddingTop:"60px",flex:1,overflow:"hidden",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[y&&t.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f0f8ff",borderRadius:"4px",border:"1px solid #b3d9ff",position:"relative",flexShrink:0},children:[t.jsx("button",{onClick:()=>j(!1),style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"16px",cursor:"pointer",color:"#666"},title:"é–‰ã˜ã‚‹",children:"Ã—"}),t.jsx("h3",{style:{marginTop:0},children:"ä½¿ç”¨æ–¹æ³•"}),t.jsxs("p",{children:["ğŸ“ ",t.jsx("strong",{children:"ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯"}),"ã—ã¦å·¥äº‹æƒ…å ±ã‚’ç·¨é›†ã§ãã¾ã™"]}),t.jsx("p",{children:"âœ… é–‹å§‹æ—¥ãƒ»çµ‚äº†æ—¥ãƒ»èª¬æ˜ãƒ»ã‚¿ã‚°ãƒ»ä¼šç¤¾åãƒ»ç¾å ´åã‚’ç·¨é›†å¯èƒ½"}),t.jsx("p",{children:"ğŸ’¾ ç·¨é›†å¾Œã¯è‡ªå‹•ã§ä¿å­˜ã•ã‚Œã¾ã™"}),t.jsx("h3",{style:{marginTop:"15px"},children:"é–‹ç™ºçŠ¶æ³"}),t.jsx("p",{children:"âœ… å·¥äº‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—"}),t.jsx("p",{children:"âœ… ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½"}),t.jsx("p",{children:"ğŸ”„ å·¥ç¨‹è¡¨æ©Ÿèƒ½ï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰"})]}),t.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",position:"relative",height:"calc(100vh - 240px)",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:"#f5f5f5",padding:"10px 15px",fontWeight:"bold",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",gap:"16px",flexShrink:0},children:[t.jsx("div",{style:{minWidth:"90px",textAlign:"center",fontSize:"14px"},children:"é–‹å§‹æ—¥"}),t.jsx("div",{style:{minWidth:"120px",fontSize:"14px"},children:"ä¼šç¤¾å"}),t.jsx("div",{style:{minWidth:"120px",fontSize:"14px"},children:"ç¾å ´å"}),t.jsx("div",{style:{flex:1}}),t.jsx("div",{style:{minWidth:"90px",textAlign:"center",fontSize:"14px",marginRight:"24px"},children:"çµ‚äº†æ—¥"}),t.jsx("div",{style:{minWidth:"80px",textAlign:"center",fontSize:"14px"},children:"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"}),t.jsx(z,{to:"/projects/gantt",style:{background:"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",textDecoration:"none",cursor:"pointer",transition:"background 0.2s",marginRight:"8px"},onMouseEnter:e=>{e.currentTarget.style.background="#45a049"},onMouseLeave:e=>{e.currentTarget.style.background="#4CAF50"},children:"ğŸ“ˆ ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ"}),t.jsx("button",{onClick:()=>j(!y),style:{background:"none",border:"1px solid #ccc",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"8px",color:"#666"},title:"ä½¿ç”¨æ–¹æ³•ã‚’è¡¨ç¤º",children:"?"})]}),t.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0},children:l.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"å·¥äº‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"}):t.jsx("div",{children:l.map((e,n)=>t.jsxs("div",{style:{padding:"15px",borderBottom:n<l.length-1?"1px solid #eee":"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",transition:"background-color 0.3s"},onClick:()=>w(e),onMouseEnter:i=>i.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:i=>i.currentTarget.style.backgroundColor="transparent",title:"ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç·¨é›†",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",width:"100%"},children:[t.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#fff",backgroundColor:"#1976d2",padding:"3px 8px",borderRadius:"4px",minWidth:"90px",textAlign:"center"},children:e.start_date?new Date(typeof e.start_date=="string"?e.start_date:e.start_date["time.Time"]).toLocaleDateString("ja-JP"):"æœªè¨­å®š"}),t.jsx("div",{style:{fontWeight:"600",fontSize:"16px",minWidth:"120px"},children:e.company_name||"ä¼šç¤¾åæœªè¨­å®š"}),t.jsx("div",{style:{fontWeight:"600",fontSize:"16px",minWidth:"120px"},children:e.location_name||"ç¾å ´åæœªè¨­å®š"}),t.jsx("div",{style:{flex:1}}),t.jsxs("div",{style:{fontSize:"14px",color:"#fff",backgroundColor:"#666",padding:"3px 8px",borderRadius:"4px",minWidth:"90px",textAlign:"center",marginRight:"24px"},children:["ï½",e.end_date?new Date(typeof e.end_date=="string"?e.end_date:e.end_date["time.Time"]).toLocaleDateString("ja-JP"):"æœªè¨­å®š"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[E(e)&&t.jsx("span",{style:{fontSize:"16px",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.5))"},title:"ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰å¤‰æ›´ãŒå¿…è¦ã§ã™",children:"âš ï¸"}),t.jsx("div",{style:{padding:"4px 16px",borderRadius:"4px",backgroundColor:e.status==="é€²è¡Œä¸­"?"#4CAF50":e.status==="å®Œäº†"?"#9E9E9E":e.status==="äºˆå®š"?"#FF9800":"#2196F3",color:"white",fontSize:"12px",minWidth:"80px",textAlign:"center"},children:e.status||"æœªè¨­å®š"})]})]},e.id||n))})})]}),t.jsx(A,{isOpen:k,onClose:R,project:_,onUpdate:C,onProjectUpdate:T})]})},N=W(function(){return t.jsx("div",{className:"container mx-auto p-4",children:t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg",children:t.jsx("div",{className:"p-6",children:t.jsx(I,{})})})})});export{N as default};
