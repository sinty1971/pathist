edition = "2023";

package grpc.v1;

import "google/protobuf/go_features.proto";
import "google/protobuf/timestamp.proto";

option features.(pb.go).api_level = API_OPAQUE;
option features.field_presence = IMPLICIT;
option go_package = "server-grpc/gen/grpc/v1;grpcv1";

// File represents information about a file or directory
message File {
  string id = 1;
  string pathist_folder = 2;
  int64 size = 3;
  google.protobuf.Timestamp modified_time = 4;
}

// Company represents a company entity with inside information
message Company {
  string id = 1;
  string pathist_folder = 2;
  string short_name = 3;
  int32 category_index = 4;
  string persist_long_name = 5;
  string persist_postal_code = 6;
  string persist_address = 7;
  string persist_tel = 8;
  string persist_fax = 9;
  string persist_email = 10;
  string persist_website = 11;
}

// CompanyCategory represents a company category with index and label
message CompanyCategory {
  int32 index = 1;
  string label = 2;
}

// Koji represents a construction project with inside information
message Koji {
  string id = 1;
  string status = 2;
  string pathist_folder = 3;
  google.protobuf.Timestamp start = 4;
  string company_name = 5;
  string location_name = 6;
  google.protobuf.Timestamp persist_end = 7;
}

// FileService provides operations for file management
service FileService {
  rpc GetFiles(GetFilesRequest) returns (GetFilesResponse);
  rpc GetFilePathistFolder(GetFilePathistFolderRequest) returns (GetFilePathistFolderResponse);
}

// CompanyService provides operations for managing companies
service CompanyService {
  rpc GetCompanies(GetCompaniesRequest) returns (GetCompaniesResponse);
  rpc GetCompany(GetCompanyRequest) returns (GetCompanyResponse);
  rpc UpdateCompany(UpdateCompanyRequest) returns (UpdateCompanyResponse);
  rpc GetCompanyCategories(GetCompanyCategoriesRequest) returns (GetCompanyCategoriesResponse);
}

// KojiService provides operations for managing construction projects
service KojiService {
  rpc GetKoji(GetKojiRequest) returns (GetKojiResponse);
  rpc GetKojies(GetKojiesRequest) returns (GetKojiesResponse);
  rpc UpdateKoji(UpdateKojiRequest) returns (UpdateKojiResponse);
}

// FileService messages
message GetFilesRequest {
  string pathist_folder = 1;
}

message GetFilesResponse {
  repeated File files = 1;
}

message GetFilePathistFolderRequest {}

message GetFilePathistFolderResponse {
  string pathist_folder = 1;
}

// CompanyService messages
message GetCompaniesRequest {
  bool refresh = 1;
}

message GetCompaniesResponse {
  map<string, Company> companies = 1;
}

message GetCompanyRequest {
  string id = 1;
}

message GetCompanyResponse {
  Company company = 1;
}

message UpdateCompanyRequest {
  string prev_id = 1;
  Company new_company = 2;
}

message UpdateCompanyResponse {
  Company prev_company = 1;
}

message GetCompanyCategoriesRequest {}

message GetCompanyCategoriesResponse {
  repeated CompanyCategory categories = 1;
}

// KojiService messages
message GetKojiesRequest {}

message GetKojiesResponse {
  map<string, Koji> kojies = 1;
}

message GetKojiRequest {
  string id = 1;
}

message GetKojiResponse {
  Koji koji = 1;
}

message UpdateKojiRequest {
  Koji new_koji = 1;
}

message UpdateKojiResponse {
  Koji prev_koji = 1;
}
